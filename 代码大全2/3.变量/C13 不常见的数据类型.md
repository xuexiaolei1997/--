# 不常见的数据类型

## 13.1 结构体

使用结构体澄清数据关系

使用结构体简化对数据块的操作

使用结构体简化参数列表

使用结构体减少维护

## 13.2 指针

### 理解指针的范式

内存中的位置

如何解释指针所指的内容

### 指针的一般使用技巧

隔离子程序或类中的指针操作

同时声明和定义指针

在相同的作用域层级上分配和释放指针

在使用之前先检查指针

在使用之前先检查指针所引用的变量

使用狗牌字段来检查损坏的内存

可以只在删除变量时做一次标记字段的检查

增加显式冗余

使用更多的指针变量以提高清晰度

按照正确的顺序删除链表中的指针

分配一片紧急备用内存

粉碎垃圾数据

在删除或释放指针后将其设置为空

在删除变量之前检查非法指针

跟踪指针分配情况

编写覆盖子程序，以这种方式避免指针问题的策略集中化

使用去指针技术

auto_ptrs

灵活使用智能指针

## 13.3 全局数据

### 全局数据的常见问题

无意中修改了全局数据

全局数据中怪异和令人惊讶的别名问题

全局数据的可重入代码问题

全局数据阻碍代码复用

全局数据使情况变得复杂

不确定的全局数据初始化顺序问题

全局数据破坏了模块化和智力的可管理性

全局数据会给模块化能力带来漏洞

### 使用全局数据的理由

保存全局值

模拟具名常量

模拟枚举类型

简化对及其常用数据的使用

消除流浪数据

### 非必要，不使用全局数据

所有变量开始都声明为局部变量，若非必要，不要设为全局变量

区分全局变量和类变量

使用访问器子程序

### 使用访问器子程序来替代全局数据

访问器子程序的优势

如何使用访问器子程序

要求所有的代码通过访问器子程序来操作数据

不要将所有的全局数据都放在一起

使用上锁来控制对全局变量的访问

在访问器子程序中构建一个抽象层

将对数据的所有访问保持在同一个抽象层上

### 如何降低使用全局数据的风险

制定一种命名规范，使全局变量一目了然

为所有全局变量创建一份注释良好的列表

不要使用全局变量保存中间结果

不要把所有数据都放在一个庞大的对象中并导出传递，假装没有在使用全局数据
